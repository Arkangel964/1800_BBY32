<!doctype html>
<html lang="en">
  <head>
   
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
        
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
    <link rel="stylesheet" href="../styles/editprofileStyle.css">

    <title>Basic Info</title>

    <!-- Firebase 8 CDNs-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous">
    </script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>

    <!-- Link to the api keys for your firebase project -->
    <script src="../scripts/firebaseAPI.js"></script>
    
  </head>
  <body>

  <div class="container rounded bg-white mt-5 mb-5">
      <div class="row">
          <div class="border-right">
              <div class="p-3 pt-4 pb-5">
                <div class="text-center d-grid gap-2 d-md-flex justify-content-end mb-3">
                  <a href="../main.html" class="btn btn-md btn-secondary" type="button">Skip for now</a>
                </div>

                  <div class="d-flex justify-content-center align-items-center mb-3">
                      <h4 class="display-4 text-right">Who are you?</h4>
                  </div>

                  <div class="form-floating mt-4">
                    <input type="text" class="form-control" id="displayName">
                    <label>*Display Name</label>
                  </div>

                  <div class="form-floating mt-4">
                    <input type="text" class="form-control" id="discord">
                    <label>Discord (Username#0000) (Optional)</label>
                  </div>

                  <div class="mt-3">
                    <select class="form-select form-select-md" id="gender" aria-label=".form-select-lg example">
                      <option selected>What's your gender?</option>
                      <option value="1">Male</option>
                      <option value="2">Female</option>
                      <option value="3">Other</option>
                    </select>
                  </div>
                  
                  <div class="row mt-3">
                    <label class="form-label">Your Birthday</label>
                    <div class="input-group">
                      <input type="text" class="form-control" id="month" placeholder="Month" aria-label="Month">
                      <input type="number" class="form-control" id="day" placeholder="Day" aria-label="Day">
                      <input type="number" class="form-control" id="year" placeholder="Year" aria-label="Year">
                    </div>
                  </div>

                  <div class="row mt-3">
                    <label class="form-label">Where do you live?</label>
                    <div class="input-group mb-3">
                      <input type="text" class="form-control" id="city" placeholder="City" aria-label="City">
                      <input type="text" class="form-control" id="state" placeholder="State" aria-label="State">
                      <input type="text" class="form-control" id="country" placeholder="Country" aria-label="Country">
                    </div>
                  </div>

                  <div class="mt-4 text-center d-grid gap-2 d-md-flex justify-content-end">
                    <a onclick="saveProfile()" class="btn btn-primary profile-button" type="button">Save</a>
                    <a href="preferences.html" id="next" class="btn btn-primary profile-button" type="button" disabled>Next Step</a>
                  </div>
              </div>
          </div>
      </div>
  </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script>
      var currentUser;
      function saveProfile() {
        firebase.auth().onAuthStateChanged(user => {
          if (user) {
            currentUser = db.collection("users").doc(user.uid);
            
            var userGender = document.getElementById('gender').value;       //get the value of the field with id="gender"
            var userDisplay = document.getElementById('displayName').value;     //get the value of the field with id="displayname"
            var userCountry = document.getElementById('country').value;       //get the value of the field with id="country"
            var userDiscord = document.getElementById('discord').value;       //get the value of the field with id="discord"
            var currentYear = new Date().getFullYear();       //get the current year
            var userAge = currentYear - document.getElementById('year').value;     //get the user's age

            currentUser.update({
              age: userAge,
              gender: userGender,
              displayName: userDisplay,
              country: userCountry,
              discordID: userDiscord
            }).then(() => {
              document.getElementById('next').disabled = false; 
              console.log("Document successfully updated!");
            })
          }
        });
      }
      
    </script>
  </body>
</html>